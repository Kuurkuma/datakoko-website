<header class="site-header">
    <nav>
        <div class="nav-container">
            <a href="{{ .Site.Home.RelPermalink }}" class="site-title {{ if .IsHome }}active{{ end }}">
                <img src="{{ "img/favicon.svg" | relURL }}" alt="{{ .Site.Title }} logo" class="site-title-logo">
                <span>{{ .Site.Title }}</span>
            </a>

            <div class="nav-menu">
                <ul class="nav-main">
                    {{ $current := . }}
                    {{ range .Site.Menus.main }}
                        {{ $menuURL := .URL }}
                        {{ if .Page }}
                            {{ $menuURL = .Page.RelPermalink }}
                        {{ end }}
                        {{ $isExact := eq $menuURL $current.RelPermalink }}
                        {{ $isMenu := or ($current.IsMenuCurrent "main" .) ($current.HasMenuCurrent "main" .) }}
                        {{ $isPrefix := hasPrefix $current.RelPermalink $menuURL }}
                        {{ $isCurrent := or $isExact (or $isMenu $isPrefix) }}
                        <li><a href="{{ $menuURL }}" class="{{ if $isCurrent }}active{{ end }}">{{ .Name }}</a></li>
                    {{ end }}
                </ul>
            </div>
        </div>
    </nav>
</header>

<script>
(function() {
    const toggle = document.querySelector('.mobile-menu-toggle');
    const menu = document.querySelector('.nav-menu');
    const header = document.querySelector('.site-header');

    if (toggle && menu) {
        toggle.addEventListener('click', function() {
            const isOpen = toggle.getAttribute('aria-expanded') === 'true';
            toggle.setAttribute('aria-expanded', !isOpen);
            toggle.classList.toggle('active');
            menu.classList.toggle('active');
            document.body.classList.toggle('menu-open');
        });

        // Close menu when clicking on a link
        const menuLinks = menu.querySelectorAll('a');
        menuLinks.forEach(link => {
            link.addEventListener('click', function() {
                toggle.setAttribute('aria-expanded', 'false');
                toggle.classList.remove('active');
                menu.classList.remove('active');
                document.body.classList.remove('menu-open');
            });
        });
    }
})();
</script>
